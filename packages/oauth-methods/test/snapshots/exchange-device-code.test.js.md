# Snapshot report for `packages/oauth-methods/test/exchange-device-code.test.js`

The actual snapshot is saved in `exchange-device-code.test.js.snap`.

Generated by [AVA](https://avajs.dev).

## README example

> Snapshot 1

    {
      access_token: 'secret123',
      scope: '',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: '1234567890abcdef1234',
      clientType: 'oauth-app',
      scopes: [],
      token: 'secret123',
    }

## with scopes

> Snapshot 1

    {
      access_token: 'secret123',
      scope: 'repo gist',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: '1234567890abcdef1234',
      clientType: 'oauth-app',
      scopes: [
        'repo',
        'gist',
      ],
      token: 'secret123',
    }

## authorization_pending error

> Snapshot 1

    HttpError (RequestError) {
      request: {
        baseUrl: 'https://github.com',
        client_id: '1234567890abcdef1234',
        device_code: 'code123',
        grant_type: 'urn:ietf:params:oauth:grant-type:device_code',
        headers: {
          accept: 'application/json',
          'user-agent': 'test',
        },
        mediaType: {
          format: '',
          previews: [],
        },
        method: 'POST',
        request: {
          fetch: Function fetchMockProxy {
            Headers: Function Headers {},
            Request: Function Request {},
            Response: Function Response {
              error: Function error {},
              json: Function json {},
              redirect: Function redirect {},
            },
            Stream: Function Stream {
              Duplex: Function Duplex {
                from: Function {},
                fromWeb: Function {},
                toWeb: Function {},
              },
              PassThrough: Function PassThrough {},
              Readable: Function Readable {
                ReadableState: Function ReadableState {},
                _fromList: Function fromList {},
                from: Function {},
                fromWeb: Function {},
                toWeb: Function {},
                wrap: Function {},
              },
              Stream: [Circular],
              Transform: Function Transform {},
              Writable: Function Writable {
                WritableState: Function WritableState {},
                fromWeb: Function {},
                toWeb: Function {},
              },
              _isUint8Array: Function isUint8Array {},
              _uint8ArrayToBuffer: Function _uint8ArrayToBuffer {},
              addAbortSignal: Function addAbortSignal {},
              compose: Function compose {},
              destroy: Function destroyer {},
              finished: Function eos {
                finished: Function finished {},
                [Symbol.for(nodejs.util.promisify.custom)]: Function finished {},
              },
              isDisturbed: Function isDisturbed {},
              isErrored: Function isErrored {},
              isReadable: Function isReadable {},
              pipeline: Function pipeline {
                [Symbol.for(nodejs.util.promisify.custom)]: Function pipeline {},
              },
              promises: {
                finished: Function finished {},
                pipeline: Function pipeline {},
              },
            },
            _calls: [
              {
                identifier: 'https://github.com/login/oauth/access_token',
                options: {
                  body: '{"client_id":"1234567890abcdef1234","device_code":"code123","grant_type":"urn:ietf:params:oauth:grant-type:device_code"}',
                  headers: {
                    accept: 'application/json',
                    'content-type': 'application/json; charset=utf-8',
                    'user-agent': 'test',
                  },
                  method: 'POST',
                  redirect: undefined,
                },
                request: undefined,
                response: Response {
                  _fmResults: {
                    json: Promise {},
                  },
                  [Symbol(realm)]: {
                    settingsObject: {},
                  },
                  [Symbol(state)]: {
                    aborted: false,
                    body: {
                      length: 97,
                      source: '{"error":"authorization_pending","error_description":"error_description","error_uri":"error_uri"}',
                      stream: ReadableStream {
                        [Symbol(kType)]: 'ReadableStream',
                        [Symbol(kState)]: {
                          controller: ReadableStreamDefaultController {
                            [Symbol(kType)]: 'ReadableStreamDefaultController',
                            [Symbol(kState)]: {
                              cancelAlgorithm: undefined,
                              closeRequested: true,
                              highWaterMark: 1,
                              pullAgain: false,
                              pullAlgorithm: undefined,
                              pulling: false,
                              queue: [],
                              queueTotalSize: 0,
                              sizeAlgorithm: undefined,
                              started: true,
                              stream: ReadableStream {
                                [Symbol(kType)]: 'ReadableStream',
                                [Symbol(kState)]: [Circular],
                                [Symbol.for(nodejs.webstream.isClosedPromise)]: {
                                  promise: Promise {},
                                  reject: Function {},
                                  resolve: Function {},
                                },
                              },
                            },
                          },
                          disturbed: true,
                          reader: ReadableStreamDefaultReader {
                            [Symbol(kType)]: 'ReadableStreamDefaultReader',
                            [Symbol(kState)]: {
                              close: {
                                promise: Promise {},
                                reject: Function {},
                                resolve: Function {},
                              },
                              readRequests: [],
                              stream: [Circular],
                            },
                          },
                          state: 'closed',
                          storedError: undefined,
                          stream: undefined,
                          transfer: {
                            port1: undefined,
                            port2: undefined,
                            promise: undefined,
                            writable: undefined,
                          },
                        },
                        [Symbol.for(nodejs.webstream.isClosedPromise)]: {
                          promise: Promise {},
                          reject: Function {},
                          resolve: Function {},
                        },
                      },
                    },
                    cacheState: '',
                    headersList: HeadersList {
                      cookies: null,
                      [Symbol(headers map)]: Map {
                        'content-length' => {
                          name: 'content-length',
                          value: '97',
                        },
                        'content-type' => {
                          name: 'content-type',
                          value: 'application/json',
                        },
                      },
                      [Symbol(headers map sorted)]: [
                        [
                          'content-length',
                          '97',
                        ],
                        [
                          'content-type',
                          'application/json',
                        ],
                      ],
                      ---
                      [
                        'content-length',
                        '97',
                      ],
                      [
                        'content-type',
                        'application/json',
                      ],
                    },
                    rangeRequested: false,
                    requestIncludesCredentials: false,
                    status: 200,
                    statusText: 'OK',
                    timingAllowPassed: false,
                    timingInfo: null,
                    type: 'default',
                    urlList: [],
                  },
                  [Symbol(headers)]: Headers {
                    [Symbol(headers list)]: HeadersList {
                      cookies: null,
                      [Symbol(headers map)]: Map {
                        'content-length' => {
                          name: 'content-length',
                          value: '97',
                        },
                        'content-type' => {
                          name: 'content-type',
                          value: 'application/json',
                        },
                      },
                      [Symbol(headers map sorted)]: [
                        [
                          'content-length',
                          '97',
                        ],
                        [
                          'content-type',
                          'application/json',
                        ],
                      ],
                      ---
                      [
                        'content-length',
                        '97',
                      ],
                      [
                        'content-type',
                        'application/json',
                      ],
                    },
                    [Symbol(guard)]: 'response',
                    [Symbol(realm)]: {
                      settingsObject: {},
                    },
                    ---
                    [
                      'content-length',
                      '97',
                    ],
                    [
                      'content-type',
                      'application/json',
                    ],
                  },
                },
                url: 'https://github.com/login/oauth/access_token',
              },
            ],
            _extractBodyThenHandle: AsyncFunction {},
            _fetchHandler: Function {},
            _holdingPromises: [
              Promise {},
              Promise {},
            ],
            _mock: Function {},
            _uncompiledRoutes: [
              [
                'https://github.com/login/oauth/access_token',
                {
                  error: 'authorization_pending',
                  error_description: 'error_description',
                  error_uri: 'error_uri',
                },
                {
                  body: {
                    client_id: '1234567890abcdef1234',
                    device_code: 'code123',
                    grant_type: 'urn:ietf:params:oauth:grant-type:device_code',
                  },
                  headers: {
                    accept: 'application/json',
                    'content-type': 'application/json; charset=utf-8',
                    'user-agent': 'test',
                  },
                  method: 'post',
                  repeat: 1,
                },
              ],
            ],
            addMatcher: Function {},
            addRoute: Function {},
            any: Function {},
            anyOnce: Function {},
            bindMethods: Function {},
            called: Function {},
            calls: Function {},
            catch: Function {},
            compileRoute: Function {},
            config: {
              Headers: Function Headers {},
              Promise: Function Promise {},
              Request: Function Request {},
              Response: Function Response {
                error: Function error {},
                json: Function json {},
                redirect: Function redirect {},
              },
              fallbackToNetwork: false,
              fetch: AsyncFunction {},
              includeContentLength: true,
              overwriteRoutes: undefined,
              sendAsJson: true,
              warnOnFallback: true,
            },
            createInstance: Function {},
            default: [Circular],
            delete: Function {},
            deleteAny: Function {},
            deleteAnyOnce: Function {},
            deleteOnce: Function {},
            done: Function {},
            executeRouter: Function {},
            fallbackResponse: undefined,
            fetchHandler: Function bound  {},
            filterCalls: Function {},
            flush: Function {},
            generateResponse: AsyncFunction {},
            get: Function {},
            getAny: Function {},
            getAnyOnce: Function {},
            getNativeFetch: Function {},
            getOnce: Function {},
            getOption: Function {},
            global: Global {},
            head: Function {},
            headAny: Function {},
            headAnyOnce: Function {},
            headOnce: Function {},
            isSandbox: true,
            lastCall: Function {},
            lastOptions: Function {},
            lastResponse: Function {},
            lastUrl: Function {},
            mock: Function {},
            needsAsyncBodyExtraction: Function {},
            once: Function {},
            patch: Function {},
            patchAny: Function {},
            patchAnyOnce: Function {},
            patchOnce: Function {},
            post: Function {},
            postAny: Function {},
            postAnyOnce: Function {},
            postOnce: Function {},
            put: Function {},
            putAny: Function {},
            putAnyOnce: Function {},
            putOnce: Function {},
            recordCall: Function {},
            reset: Function bound  {},
            resetBehavior: Function bound  {},
            resetHistory: Function bound  {},
            restore: Function bound  {},
            router: Function {},
            routes: [
              Route {
                body: {
                  client_id: '1234567890abcdef1234',
                  device_code: 'code123',
                  grant_type: 'urn:ietf:params:oauth:grant-type:device_code',
                },
                fetchMock: [Circular],
                functionMatcher: undefined,
                headers: {
                  accept: 'application/json',
                  'content-type': 'application/json; charset=utf-8',
                  'user-agent': 'test',
                },
                identifier: 'https://github.com/login/oauth/access_token',
                matcher: Function {},
                method: 'post',
                repeat: 1,
                reset: Function {},
                response: {
                  error: 'authorization_pending',
                  error_description: 'error_description',
                  error_uri: 'error_uri',
                },
                url: 'https://github.com/login/oauth/access_token',
                usesBody: true,
              },
            ],
            sandbox: Function {},
            spy: Function {},
            statusTextMap: {
              100: 'Continue',
              101: 'Switching Protocols',
              102: 'Processing',
              103: 'Early Hints',
              200: 'OK',
              201: 'Created',
              202: 'Accepted',
              203: 'Non-Authoritative Information',
              204: 'No Content',
              205: 'Reset Content',
              206: 'Partial Content',
              207: 'Multi-Status',
              208: 'Already Reported',
              226: 'IM Used',
              300: 'Multiple Choices',
              301: 'Moved Permanently',
              302: 'Found',
              303: 'See Other',
              304: 'Not Modified',
              305: 'Use Proxy',
              307: 'Temporary Redirect',
              308: 'Permanent Redirect',
              400: 'Bad Request',
              401: 'Unauthorized',
              402: 'Payment Required',
              403: 'Forbidden',
              404: 'Not Found',
              405: 'Method Not Allowed',
              406: 'Not Acceptable',
              407: 'Proxy Authentication Required',
              408: 'Request Timeout',
              409: 'Conflict',
              410: 'Gone',
              411: 'Length Required',
              412: 'Precondition Failed',
              413: 'Payload Too Large',
              414: 'URI Too Long',
              415: 'Unsupported Media Type',
              416: 'Range Not Satisfiable',
              417: 'Expectation Failed',
              418: 'I\'m a Teapot',
              421: 'Misdirected Request',
              422: 'Unprocessable Entity',
              423: 'Locked',
              424: 'Failed Dependency',
              425: 'Too Early',
              426: 'Upgrade Required',
              428: 'Precondition Required',
              429: 'Too Many Requests',
              431: 'Request Header Fields Too Large',
              451: 'Unavailable For Legal Reasons',
              500: 'Internal Server Error',
              501: 'Not Implemented',
              502: 'Bad Gateway',
              503: 'Service Unavailable',
              504: 'Gateway Timeout',
              505: 'HTTP Version Not Supported',
              506: 'Variant Also Negotiates',
              507: 'Insufficient Storage',
              508: 'Loop Detected',
              509: 'Bandwidth Limit Exceeded',
              510: 'Not Extended',
              511: 'Network Authentication Required',
            },
            sticky: Function {},
          },
        },
        url: '/login/oauth/access_token',
      },
      response: {
        data: {
          error: 'authorization_pending',
          error_description: 'error_description',
          error_uri: 'error_uri',
        },
        headers: {
          'content-length': '97',
          'content-type': 'application/json',
        },
        status: 200,
        url: '',
      },
      status: 400,
      message: 'error_description (authorization_pending, error_uri)',
    }

## OAuth App with ClientSecret

> Snapshot 1

    {
      access_token: 'secret123',
      scope: '',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: '1234567890abcdef1234',
      clientSecret: '1234567890abcdef12347890abcdef12345678',
      clientType: 'oauth-app',
      scopes: [],
      token: 'secret123',
    }

## GitHub App

> Snapshot 1

    {
      access_token: 'secret123',
      scope: '',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: 'lv1.1234567890abcdef',
      clientType: 'github-app',
      token: 'secret123',
    }

## GitHub App with clientSecret

> Snapshot 1

    {
      access_token: 'secret123',
      scope: '',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: 'lv1.1234567890abcdef',
      clientSecret: '1234567890abcdef12347890abcdef12345678',
      clientType: 'github-app',
      token: 'secret123',
    }

## Refresh token

> Snapshot 1

    {
      access_token: 'secret123',
      expires_in: 28800,
      refresh_token: 'r1.token123',
      refresh_token_expires_in: 15897600,
      scope: '',
      token_type: 'bearer',
    }

> Snapshot 2

    {
      clientId: 'lv1.1234567890abcdef',
      clientType: 'github-app',
      expiresAt: '1970-01-01T08:00:00.000Z',
      refreshToken: 'r1.token123',
      refreshTokenExpiresAt: '1970-07-04T00:00:00.000Z',
      token: 'secret123',
    }
